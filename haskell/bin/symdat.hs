-- |This program displays the group data (as calculated by "GrData") for a
-- group generated from a list of permutations specified on the command line.
-- Each permutation must be written as a sequence of cycles separated by @/@
-- where each cycle is a sequence of positive integers separated by @,@.  For
-- example, the command:
--
-- > symdat 1,2/3,4 3,4,5
--
-- displays the data for the group generated by (1 2)(3 4) and (3 4 5)

import Data.List (intercalate)
import System.Environment (getArgs)
import Groups.Families (permutation)
import qualified Permutation as P
import GrData

main :: IO ()
main = do argv@(_:_) <- getArgs
	  let perms = map (P.fromCycles . map (map read . splitElem ',')
					. splitElem '/') argv
	      name  = '⟨' : intercalate ", " (map P.showCycles perms) ++ "⟩"
	  putStr $ grdata' (name, permutation perms, [])

splitElem :: Eq a => a -> [a] -> [[a]]
-- split on all occurrences of an element
splitElem _ [] = [[]]
splitElem e xs = pre : if null post then [] else splitElem e (tail post)
 where (pre, post) = break (== e) xs
